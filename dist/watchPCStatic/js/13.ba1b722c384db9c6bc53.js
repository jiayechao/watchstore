webpackJsonp([13],{"7aQp":function(t,e){},"WcB/":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Q0Ca"),a=s("mEoW"),l=s("Vo7i"),n={data:function(){return{itemDetail:{},currentStyle:0,paramsImgs:[],count:1,styleNum:0,distance:0,nowTime:"",presaleEndTimestamp:""}},beforeRouteEnter:function(t,e,s){Object(l.b)({url:a.a.GET_ITEM_DETAIL,data:{itemBaseId:t.params.id}}).then(function(t){s(function(e){e.itemDetail=t.data,e.nowTime=t.times,e.presaleEndTimestamp=t.data.presaleEndTimestamp,e.paramsImgs=t.data.detailImgUrls.concat(t.data.paramsImgUrls)})})},beforeRouteUpdate:function(t,e,s){var i=this;this.$fetchPost({url:this.$api.GET_ITEM_DETAIL,data:{itemBaseId:t.params.id}}).then(function(t){i.itemDetail=t.data,i.nowTime=t.times,i.presaleEndTimestamp=t.data.presaleEndTimestamp,i.paramsImgs=t.data.detailImgUrls.concat(t.data.paramsImgUrls),s()})},created:function(){},computed:{finishTime:function(){var t=Math.abs(this.presaleEndTimestamp-this.nowTime)/1e3,e=0,s=0,i=0;return e=parseInt(t/60),t%=60,e>60&&(s=parseInt(e/60),e%=60),s>24&&(i=parseInt(s/24),s%=24),i+"天"+s+"小时"+e+"分"},currentColorImgUrl:function(){return this.itemDetail.styleList[this.currentStyle].styleImgUrls[this.styleNum]},currentStyleImgUrls:function(){return this.itemDetail.styleList[this.currentStyle].styleImgUrls},currentColorPrice:function(){return this.itemDetail.styleList[this.currentStyle].stylePrice},totalPrice:function(){return Object(i.fixed)(this.count*this.currentColorPrice)},itemStyleId:function(){return this.itemDetail.styleList[this.currentStyle].itemStyleId}},methods:{changeStyleColor:function(t){this.currentStyle=t,this.styleNum=this.distance=0},buyNow:function(){var t=this;this.$fetchPost({url:this.$api.DIRECT_ORDER,data:{itemStyleId:this.itemStyleId,num:this.count}}).then(function(e){t.$store.commit("ADD_CURRENT_GOODS",e.data),t.$router.push({path:"/purchase"})}).catch(function(e){console.log(e),6===e.code||10===e.code?t.$router.push({path:"/signin",query:{redirect:t.$route.path}}):t.$message.error(e.msg)})},presalesGoods:function(){var t=this;this.$fetchPost({url:this.$api.GET_PRESALE_CART_INFO,data:{itemStyleId:this.itemStyleId,num:this.count}}).then(function(e){t.$store.commit("ADD_CURRENT_GOODS",e.data),t.$router.push({path:"/purchase"})}).catch(function(e){console.log(e),6===e.code||10===e.code?t.$router.push({path:"/signin",query:{redirect:t.$route.path}}):t.$message.error(e.msg)})},addCart:function(){var t=this;this.$fetchPost({url:this.$api.ADD_CARD,data:{itemStyleId:this.itemStyleId,num:this.count}}).then(function(e){t.$message({message:"添加成功",type:"success"})}).catch(function(e){console.log(e),t.$router.push({path:"/signin",query:{redirect:t.$route.path}})})},toLeft:function(){var t=102*(this.currentStyleImgUrls.length-1);Math.abs(this.distance)<t&&(this.distance=this.distance-408)},toRight:function(){var t=102*(this.currentStyleImgUrls.length-1);Math.abs(this.distance)>=t&&(this.distance=this.distance+408)}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detail-wrap"},[s("div",{staticClass:"detail"},[s("div",{staticClass:"detail-imgs fl"},[t.itemDetail.styleList?s("div",{staticClass:"big-img",style:{backgroundImage:"url("+t.currentColorImgUrl+")"}}):t._e(),t._v(" "),s("div",{staticStyle:{overflow:"hidden"}},[s("span",{staticClass:"to-left fl",on:{click:t.toLeft}},[s("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),s("div",{staticClass:"small-img-wrap fl"},[t.itemDetail.styleList?s("div",{staticClass:"small-img",style:{width:102*t.currentStyleImgUrls.length+"px",left:t.distance+"px"}},t._l(t.currentStyleImgUrls,function(e,i){return s("span",{key:i,staticClass:"fl",class:{active:i===t.styleNum},style:{backgroundImage:"url("+e+")"},on:{click:function(e){t.styleNum=i}}})})):t._e()]),t._v(" "),s("span",{staticClass:"to-right fl",on:{click:t.toRight}},[s("i",{staticClass:"el-icon-arrow-right"})])])]),t._v(" "),s("div",{staticClass:"detail-info"},[s("p",{staticClass:"title"},[t._v(t._s(t.itemDetail.itemName))]),t._v(" "),s("p",{staticClass:"desc"},[t._v(t._s(t.itemDetail.itemDescr))]),t._v(" "),t.itemDetail.styleList?s("p",{staticClass:"price"},[t._v("￥"+t._s(t.totalPrice))]):t._e(),t._v(" "),s("div",{staticClass:"style-color"},[s("span",{staticClass:"label"},[t._v("颜色")]),t._v(" "),t.itemDetail.styleList?s("div",{staticClass:"color-wrap"},t._l(t.itemDetail.styleList,function(e,i){return s("div",{key:i,staticClass:"color-btn",class:{active:i===t.currentStyle},on:{click:function(e){t.changeStyleColor(i)}}},[s("span",{staticClass:"color-bg",style:{backgroundImage:"url("+e.colorImgUrl+")"}}),s("span",{staticClass:"color-name"},[t._v(t._s(e.colorDescr))])])})):t._e()]),t._v(" "),s("div",{staticClass:"count-wrap"},[s("span",{staticClass:"label"},[t._v("数量")]),t._v(" "),1===t.itemDetail.isPresale?[s("el-input-number",{attrs:{min:1,max:2,size:"mini"},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}}),t._v(" "),s("span",{staticStyle:{"font-size":"12px",color:"#888"}},[t._v("（每个ID限购2个）")])]:s("el-input-number",{attrs:{min:1,max:t.itemDetail.stock||1/0,size:"mini"},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}})],2),t._v(" "),s("div",{staticClass:"btn-wrap"},[0===t.itemDetail.isPresale?[s("el-button",{staticClass:"custom-bg",attrs:{type:"primary",disabled:0===t.itemDetail.saleState},on:{click:t.buyNow}},[t._v("立即购买")]),t._v(" "),s("el-button",{staticClass:"addCart",attrs:{plain:"",disabled:0===t.itemDetail.saleState},on:{click:t.addCart}},[t._v("加入购物车")])]:1===t.itemDetail.isPresale?[s("el-button",{staticClass:"custom-bg presale",attrs:{type:"primary",disabled:0===t.itemDetail.saleState},on:{click:t.presalesGoods}},[s("span",{staticStyle:{"font-size":"26px"}},[t._v("￥"+t._s(t.itemDetail.presalePrice)+" ")]),t._v(" 抢预售名额")]),t._v(" "),s("p",{staticClass:"finishTime"},[t._v("距抢购结束："+t._s(t.finishTime))])]:t._e()],2)])]),t._v(" "),t._l(t.paramsImgs,function(t,e){return s("div",{key:e,staticClass:"paramsImg",style:{backgroundImage:"url("+t+")"}})})],2)},staticRenderFns:[]};var c=s("VU/8")(n,r,!1,function(t){s("7aQp")},"data-v-67739058",null);e.default=c.exports}});