webpackJsonp([4],{"/8qZ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("woOf"),r=a.n(s),i=a("oH71"),o={data:function(){return{addressDialogVisible:!1,addressList:[],addEdit:!1,addressForm:{}}},created:function(){var e=this;Object(i.c)().then(function(t){e.addressList=t.data.addressList})},methods:{openAddDialog:function(){this.addEdit=!1,this.addressForm={},this.addressDialogVisible=!0},closeAddDialog:function(e){var t=this;this.addressDialogVisible=!1,Object(i.c)().then(function(e){t.addressList=e.data.addressList})},changeDefault:function(e){var t=this;Object(i.d)(e).then(function(e){return Object(i.c)()}).then(function(e){t.addressList=e.data.addressList})},deleteList:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Object(i.b)(e).then(function(e){t.$message({message:"删除成功",type:"success"})}),Object(i.c)().then(function(e){console.log(e),t.addressList=e.data.addressList})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},editAddress:function(e){this.addEdit=!0,this.addressForm=r()({},e),this.addressDialogVisible=!0}},components:{"el-address":a("wsvf").a}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"address-list"},[a("el-button",{staticClass:"custom-bg",attrs:{type:"primary"},on:{click:e.openAddDialog}},[e._v("添加新地址")]),e._v(" "),a("div",{staticClass:"list-wrap"},e._l(e.addressList,function(t,s){return a("div",{key:s,staticClass:"address-item fl"},[a("p",{staticClass:"name"},[a("i",{staticClass:"el-icon el-icon-location-outline"}),e._v(e._s(t.receiver))]),e._v(" "),a("div",{staticClass:"item-wrap"},[a("p",{staticClass:"phone"},[e._v(e._s(t.phone))]),e._v(" "),a("p",{staticClass:"address"},[e._v(e._s(t.provinceName)+e._s(t.cityName)+e._s(t.areaName)+e._s(t.addressDetail))]),e._v(" "),a("p",{staticClass:"zipcode"},[e._v("邮编："+e._s(t.zipCode))]),e._v(" "),a("el-checkbox",{staticClass:"has_checked",attrs:{"true-label":1,"false-label":0,name:"type"},on:{change:function(a){e.changeDefault({addressId:t.addressId})}},model:{value:t.isDefault,callback:function(a){e.$set(t,"isDefault",a)},expression:"item.isDefault"}},[e._v("默认地址")]),e._v(" "),a("div",{staticClass:"handle"},[a("a",{staticClass:"delete fr",attrs:{href:"javascript:;"},on:{click:function(a){a.stopPropagation(),e.deleteList({addressId:t.addressId})}}},[a("i",{staticClass:"el-icon el-icon-delete"}),e._v("删除")]),e._v(" "),a("a",{staticClass:"edit fr",attrs:{href:"javascript:;"},on:{click:function(a){a.stopPropagation(),e.editAddress(t)}}},[a("i",{staticClass:"el-icon el-icon-edit-outline"}),e._v("编辑")])])],1)])})),e._v(" "),a("el-dialog",{attrs:{"custom-class":"address-dialog hasCancel",width:"675px",visible:e.addressDialogVisible},on:{"update:visible":function(t){e.addressDialogVisible=t}}},[a("p",{attrs:{slot:"title"},slot:"title"},[e.addEdit?a("span",[a("i",{staticClass:"el- icon el-icon-edit-outline"}),e._v(" 修改地址")]):a("span",[e._v("+ 新建地址")])]),e._v(" "),a("el-address",{attrs:{addressDialogVisible:e.addressDialogVisible,addEdit:e.addEdit,addressForm:e.addressForm},on:{closeAddDialog:e.closeAddDialog}},[a("el-button",{staticClass:"cancel",attrs:{plain:""},on:{click:function(t){e.addressDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(o,n,!1,function(e){a("57+e")},"data-v-08c222c6",null);t.default=d.exports},"57+e":function(e,t){},bbid:function(e,t){},oH71:function(e,t,a){"use strict";a.d(t,"c",function(){return n}),a.d(t,"a",function(){return d}),a.d(t,"e",function(){return c}),a.d(t,"b",function(){return l}),a.d(t,"d",function(){return u});var s=a("//Fk"),r=a.n(s),i=a("mEoW"),o=a("Vo7i");function n(){return new r.a(function(e,t){Object(o.b)({url:i.a.ADDRESS_LIST,data:{page:1,pageSize:100}}).then(function(t){e(t)}).catch(function(e){t(e)})})}function d(e){return new r.a(function(t,a){Object(o.b)({url:i.a.ADD_ADDRESS,data:e}).then(function(e){t(e)}).catch(function(e){a(e)})})}function c(e){return new r.a(function(t,a){Object(o.b)({url:i.a.UPDATE_ADDRESS,data:e}).then(function(e){t(e)}).catch(function(e){a(e)})})}function l(e){return new r.a(function(t,a){Object(o.b)({url:i.a.DEL_ADDRESS,data:e}).then(function(e){t(e)}).catch(function(e){a(e)})})}function u(e){return new r.a(function(t,a){Object(o.b)({url:i.a.RESET_DEFAULT_ADDRESS,data:e}).then(function(e){t(e)}).catch(function(e){a(e)})})}},wsvf:function(e,t,a){"use strict";var s=a("//Fk"),r=a.n(s),i=a("oH71"),o=function(e){return new r.a(function(t,a){var s=e.$tools.getItem(e.addressFormData.provinceCode,1);if(s&&s.length)return e.cities=s,t(s);e.$fetchGet({url:e.$api.GET_CITY_LIST,params:{provinceCode:e.addressFormData.provinceCode}}).then(function(a){return e.$tools.setItem(e.addressFormData.provinceCode,a.data,1),e.cities=a.data,t(a.data)}).catch(function(e){return console.log(e),a(new Error("获取城市失败"))})})},n=function(e){return new r.a(function(t,a){var s=e.$tools.getItem(e.addressFormData.cityCode,1);if(console.log(s),s&&s.length)return e.areas=s,t(s);e.$fetchGet({url:e.$api.GET_AREA_LIST,params:{cityCode:e.addressFormData.cityCode}}).then(function(a){return e.$tools.setItem(e.addressFormData.cityCode,a.data,1),e.areas=a.data,t(a.data)}).catch(function(e){return console.log(e),a(new Error("获取地区失败"))})})},d={props:{addressForm:{type:Object,dafault:{receiver:"",provinceCode:"",cityCode:"",areaCode:"",addressDetail:"",phone:"",zipCode:"",isDefault:0}},addEdit:{type:Boolean},addressDialogVisible:{type:Boolean}},data:function(){return{provinces:[],cities:[],areas:[],rules:{receiver:[{required:!0,message:"请输入收货人姓名",trigger:"blur"}],provinceCode:[{required:!0,message:"请选择省",trigger:"change"}],cityCode:[{required:!0,message:"请选择市",trigger:"change"}],areaCode:[{required:!0,message:"请选择区",trigger:"change"}],addressDetail:[{required:!0,message:"请输入详细地址",trigger:"blur"}],phone:[{validator:function(e,t,a){!/^1[34578]\d{9}$/.test(t)&&t?a(new Error("请输入真实的手机号")):a()},type:"number",trigger:"blur"}],zipCode:[{validator:function(e,t,a){!/^\d{6}$/.test(t)&&t?a(new Error("请输入真实的邮编")):a()},type:"number",trigger:"blur"}]}}},watch:{addressDialogVisible:function(e,t){e&&this.addressFormData.provinceCode&&(o(this),n(this))}},computed:{addressFormData:function(){return this.addressForm}},created:function(){var e=this,t=this.$tools.getItem("province",1);t&&t.length?this.provinces=t:this.$fetchGet({url:this.$api.GET_PROVINCE_LIST}).then(function(t){e.$tools.setItem("province",t.data,1),e.provinces=t.data}),this.addressFormData.provinceCode&&(o(this),n(this))},methods:{changeProvince:function(e){var t=this;o(this).then(function(e){t.$set(t.addressFormData,"cityCode",t.cities[0].cityCode)}).then(function(e){return n(t)}).then(function(e){console.log("then",t.areas),t.$set(t.addressFormData,"areaCode",t.areas[0].areaCode)})},changeCity:function(e){var t=this;n(this).then(function(e){t.$set(t.addressFormData,"areaCode",t.areas[0].areaCode)})},saveAdd:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return console.log("error submit!!"),!1;t.addEdit?Object(i.e)(t.addressFormData).then(function(a){t.$emit("closeAddDialog"),t.$refs[e].resetFields()}):Object(i.a)(t.addressFormData).then(function(a){console.log(a),t.$emit("closeAddDialog",a),t.$refs[e].resetFields()})})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"addressForm",staticClass:"addressForm",attrs:{model:e.addressFormData,rules:e.rules,"label-width":"92px"}},[a("el-form-item",{attrs:{label:"收货人",prop:"receiver"}},[a("el-input",{staticStyle:{width:"120px"},model:{value:e.addressFormData.receiver,callback:function(t){e.$set(e.addressFormData,"receiver",t)},expression:"addressFormData.receiver"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在地区",required:""}},[a("el-col",{attrs:{span:120}},[a("el-form-item",{attrs:{prop:"provinceCode"}},[a("el-select",{attrs:{placeholder:"省"},on:{change:e.changeProvince},model:{value:e.addressFormData.provinceCode,callback:function(t){e.$set(e.addressFormData,"provinceCode",t)},expression:"addressFormData.provinceCode"}},e._l(e.provinces,function(e){return a("el-option",{key:e.provinceCode,attrs:{label:e.provinceName,value:e.provinceCode}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:120}},[a("el-form-item",{attrs:{prop:"cityCode"}},[a("el-select",{attrs:{placeholder:"市"},on:{change:e.changeCity},model:{value:e.addressFormData.cityCode,callback:function(t){e.$set(e.addressFormData,"cityCode",t)},expression:"addressFormData.cityCode"}},e._l(e.cities,function(e){return a("el-option",{key:e.cityCode,attrs:{label:e.viewCityName,value:e.cityCode}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:120}},[a("el-form-item",{attrs:{prop:"areaCode"}},[a("el-select",{attrs:{placeholder:"区"},model:{value:e.addressFormData.areaCode,callback:function(t){e.$set(e.addressFormData,"areaCode",t)},expression:"addressFormData.areaCode"}},e._l(e.areas,function(e){return a("el-option",{key:e.areaCode,attrs:{label:e.areaName,value:e.areaCode}})}))],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"详细地址",prop:"addressDetail"}},[a("el-input",{model:{value:e.addressFormData.addressDetail,callback:function(t){e.$set(e.addressFormData,"addressDetail",t)},expression:"addressFormData.addressDetail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{type:"tel"},model:{value:e.addressFormData.phone,callback:function(t){e.$set(e.addressFormData,"phone",t)},expression:"addressFormData.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮政编码",prop:"zipCode"}},[a("el-input",{staticStyle:{width:"220px"},model:{value:e.addressFormData.zipCode,callback:function(t){e.$set(e.addressFormData,"zipCode",t)},expression:"addressFormData.zipCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-checkbox",{staticClass:"has_checked",attrs:{"true-label":1,"false-label":0,name:"type",label:"设置为默认地址"},model:{value:e.addressFormData.isDefault,callback:function(t){e.$set(e.addressFormData,"isDefault",t)},expression:"addressFormData.isDefault"}})],1),e._v(" "),a("el-form-item",{staticClass:"btn-wrap"},[a("el-button",{staticClass:"custom-bg custom-height",attrs:{type:"primary"},on:{click:function(t){e.saveAdd("addressForm")}}},[e._v("保存并使用")]),e._v(" "),e._t("default")],2)],1)},staticRenderFns:[]};var l=a("VU/8")(d,c,!1,function(e){a("bbid")},"data-v-a94fab28",null);t.a=l.exports}});